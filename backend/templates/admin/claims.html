{% extends "admin/base_site.html" %}
{% load static %}

{% block extrahead %}
  {{ block.super }}
  <link rel="stylesheet" type="text/css" href="{% static 'admin/css/custom.css' %}">
  <style>
    .claims-container {
      max-width: 1024px;
      margin: 0 auto;
      padding: 1.5rem;
    }
    
    .tab-button {
      padding: 0.5rem 0.25rem;
      font-size: 0.875rem;
      font-weight: 500;
      border-bottom: 2px solid transparent;
    }
    
    .tab-button.active {
      color: #e87d30;
      border-bottom: 2px solid #e87d30;
    }
    
    .tab-button:not(.active) {
      color: #6b7280;
    }
    
    .tab-button:not(.active):hover {
      color: #374151;
    }
    
    .filter-button {
      display: flex;
      align-items: center;
      font-size: 0.875rem;
      color: #374151;
      background-color: #ffffff;
      border: 1px solid #d1d5db;
      border-radius: 0.375rem;
      padding: 0.5rem 0.75rem;
      cursor: pointer;
    }
    
    .filter-button:hover {
      background-color: #f9fafb;
    }
    
    .claims-table {
      width: 100%;
      border-collapse: collapse;
      background-color: #ffffff;
      border-radius: 0.5rem;
      box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
      border: 1px solid #e5e7eb;
    }
    
    .table-header {
      background-color: #f9fafb;
    }
    
    .table-header th {
      padding: 0.75rem 1.5rem;
      text-align: left;
      font-size: 0.75rem;
      font-weight: 500;
      color: #6b7280;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    
    .table-row {
      border-bottom: 1px solid #e5e7eb;
    }
    
    .table-row:hover {
      background-color: #f9fafb;
    }
    
    .table-cell {
      padding: 1rem 1.5rem;
      font-size: 0.875rem;
      color: #374151;
    }
    
    .status-pending {
      padding: 0.125rem 0.5rem;
      border-radius: 9999px;
      font-size: 0.75rem;
      font-weight: 500;
      background-color: #fef3c7;
      color: #92400e;
    }
    
    .status-approved {
      padding: 0.125rem 0.5rem;
      border-radius: 9999px;
      font-size: 0.75rem;
      font-weight: 500;
      background-color: #dcfce7;
      color: #15803d;
    }
    
    .status-fraud {
      padding: 0.125rem 0.5rem;
      border-radius: 9999px;
      font-size: 0.75rem;
      font-weight: 500;
      background-color: #fee2e2;
      color: #b91c1c;
    }
    
    .view-button {
      display: flex;
      align-items: center;
      color: #e87d30;
      background: none;
      border: none;
      cursor: pointer;
      font-size: 0.875rem;
    }
    
    .filter-dropdown {
      position: absolute;
      right: 0;
      margin-top: 0.5rem;
      width: 12rem;
      background-color: #ffffff;
      border-radius: 0.375rem;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      border: 1px solid #e5e7eb;
      padding: 0.5rem;
      z-index: 10;
    }
    
    .filter-option {
      font-size: 0.875rem;
      color: #374151;
      padding: 0.5rem;
      cursor: pointer;
    }
    
    .filter-option:hover {
      background-color: #f9fafb;
    }
  </style>
{% endblock %}

{% block content %}
<div class="claims-container">
  <!-- Header -->
  <div class="mb-8">
    <h1 class="text-2xl font-bold text-gray-900 mb-2 mt-4 text-center">Claims</h1>
    <p class="text-gray-600 text-center">Manage and process insurance claims efficiently.</p>
  </div>

  <!-- Tabs and Filter -->
  <div class="flex justify-between items-center mb-6">
    <div class="flex space-x-4 border-b border-gray-200">
      <button
        class="tab-button {% if active_tab == 'All' %}active{% endif %}"
        onclick="setActiveTab('All')"
      >
        All
      </button>
      <button
        class="tab-button {% if active_tab == 'Pending' %}active{% endif %}"
        onclick="setActiveTab('Pending')"
      >
        Pending
      </button>
      <button
        class="tab-button {% if active_tab == 'Approved' %}active{% endif %}"
        onclick="setActiveTab('Approved')"
      >
        Approved
      </button>
      <button
        class="tab-button {% if active_tab == 'Fraud Flagged' %}active{% endif %}"
        onclick="setActiveTab('Fraud Flagged')"
      >
        Fraud Flagged
      </button>
    </div>

    <div class="relative">
      <button 
        id="filter-button"
        class="filter-button"
        onclick="toggleFilter()"
      >
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-funnel" viewBox="0 0 16 16">
          <path d="M1.5 1.5A.5.5 0 0 1 2 1h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.128.334L10 8.692V13.5a.5.5 0 0 1-.342.474l-3 1A.5.5 0 0 1 6 14.5V8.692L1.628 3.834A.5.5 0 0 1 1.5 3.5v-2zm1 .5v1.308l4.372 4.858A.5.5 0 0 1 7 8.5v5.306l2-.666V8.5a.5.5 0 0 1 .128-.334L13.5 3.308V2h-11z"/>
        </svg>
        <span class="ml-2">Filter</span>
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-down ml-2" viewBox="0 0 16 16">
          <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
        </svg>
      </button>
      <div id="filter-dropdown" class="filter-dropdown hidden">
        <div class="filter-option">Date Range</div>
        <div class="filter-option">Customer</div>
        <div class="filter-option">Claim Type</div>
      </div>
    </div>
  </div>

  <!-- Claims Table -->
  <div class="overflow-hidden">
    <table class="claims-table">
      <thead class="table-header">
        <tr>
          <th>Claim ID</th>
          <th>Customer</th>
          <th>Date</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for claim in claims %}
        <tr class="table-row">
          <td class="table-cell">{{ claim.claim_id }}</td>
          <td class="table-cell">{{ claim.user.full_name }}</td>
          <td class="table-cell">{{ claim.incident_date }}</td>
          <td class="table-cell">
            {% if claim.status == 'pending' %}
              <span class="status-pending">Pending</span>
            {% elif claim.status == 'approved' %}
              <span class="status-approved">Approved</span>
            {% elif claim.status == 'rejected' %}
              <span class="status-fraud">Rejected</span>
            {% else %}
              <span class="status-fraud">Fraud Flagged</span>
            {% endif %}
          </td>
          <td class="table-cell">
            <a href="{% url 'admin:claim_detail' claim.id %}" class="view-button">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye" viewBox="0 0 16 16">
                <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zM1.173 8a13.133 13.133 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.133 13.133 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5c-2.12 0-3.879-1.168-5.168-2.457A13.134 13.134 0 0 1 1.172 8z"/>
                <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5zM4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0z"/>
              </svg>
              <span class="ml-1">View</span>
            </a>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<script>
  function setActiveTab(tab) {
    // In a real implementation, this would filter the claims based on the selected tab
    // For now, we'll just reload the page with the tab parameter
    location.href = '?tab=' + encodeURIComponent(tab);
  }

  function toggleFilter() {
    const dropdown = document.getElementById('filter-dropdown');
    dropdown.classList.toggle('hidden');
  }

  function viewClaim(claimId) {
    // In a real implementation, this would navigate to the claim details page
    alert('Viewing claim with ID: ' + claimId);
  }

  // Close filter dropdown when clicking outside
  document.addEventListener('click', function(event) {
    const filterButton = document.getElementById('filter-button');
    const dropdown = document.getElementById('filter-dropdown');
    
    if (!filterButton.contains(event.target) && !dropdown.contains(event.target)) {
      dropdown.classList.add('hidden');
    }
  });
</script>
{% endblock %}
